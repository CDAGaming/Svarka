--- ../src-base/minecraft/net/minecraft/entity/EntityAreaEffectCloud.java
+++ ../src-work/minecraft/net/minecraft/entity/EntityAreaEffectCloud.java
@@ -2,6 +2,8 @@
 
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
+
+import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
@@ -23,7 +25,12 @@
 import net.minecraft.util.math.MathHelper;
 import net.minecraft.world.World;
 import net.minecraft.world.WorldServer;
+import org.bukkit.craftbukkit.entity.CraftLivingEntity; // CraftBukkit
+import org.bukkit.entity.LivingEntity; // CraftBukkit
 
+import org.bukkit.craftbukkit.entity.CraftLivingEntity;
+import org.bukkit.entity.LivingEntity;
+
 public class EntityAreaEffectCloud extends Entity
 {
     private static final DataParameter<Float> field_184498_a = EntityDataManager.<Float>func_187226_a(EntityAreaEffectCloud.class, DataSerializers.field_187193_c);
@@ -33,15 +40,15 @@
     private static final DataParameter<Integer> field_189736_e = EntityDataManager.<Integer>func_187226_a(EntityAreaEffectCloud.class, DataSerializers.field_187192_b);
     private static final DataParameter<Integer> field_189737_f = EntityDataManager.<Integer>func_187226_a(EntityAreaEffectCloud.class, DataSerializers.field_187192_b);
     private PotionType field_184502_e;
-    private final List<PotionEffect> field_184503_f;
+    public final List<PotionEffect> field_184503_f;
     private final Map<Entity, Integer> field_184504_g;
     private int field_184505_h;
-    private int field_184506_as;
-    private int field_184507_at;
+    public int field_184506_as;
+    public int field_184507_at;
     private boolean field_184508_au;
-    private int field_184509_av;
-    private float field_184510_aw;
-    private float field_184511_ax;
+    public int field_184509_av;
+    public float field_184510_aw;
+    public float field_184511_ax;
     private EntityLivingBase field_184512_ay;
     private UUID field_184513_az;
 
@@ -64,6 +71,21 @@
         this(p_i46810_1_);
         this.func_70107_b(p_i46810_2_, p_i46810_4_, p_i46810_6_);
     }
+    // CraftBukkit start accessor methods
+    public void refreshEffects() {
+    	if (!this.field_184508_au) {
+    		this.func_184212_Q().func_187227_b(EntityAreaEffectCloud.field_184499_b, Integer.valueOf(PotionUtils.func_185181_a(PotionUtils.func_185186_a(this.field_184502_e, this.field_184503_f)))); // PAIL: rename
+    	}
+    }
+    
+    public String getType() {
+    	return PotionType.field_185176_a.func_177774_c(this.field_184502_e).toString();
+    }
+    
+    public void setType(String string) {
+    	this.func_184484_a(PotionType.field_185176_a.func_82594_a(new ResourceLocation(string)));
+    }
+    // CraftBukkit end
 
     protected void func_70088_a()
     {
@@ -321,6 +343,7 @@
 
                     if (!list.isEmpty())
                     {
+                    	List<LivingEntity> entities = new ArrayList<LivingEntity>(); // CraftBukkit
                         for (EntityLivingBase entitylivingbase : list)
                         {
                             if (!this.field_184504_g.containsKey(entitylivingbase) && entitylivingbase.func_184603_cC())
@@ -329,8 +352,18 @@
                                 double d1 = entitylivingbase.field_70161_v - this.field_70161_v;
                                 double d2 = d0 * d0 + d1 * d1;
 
-                                if (d2 <= (double)(f * f))
-                                {
+                                if (d2 <= (double)(f * f)) {
+                                	// CraftBukkit start
+                                	entities.add((LivingEntity) entitylivingbase.getBukkitEntity());
+                                }
+                            }
+                        }
+                        org.bukkit.event.entity.AreaEffectCloudApplyEvent event = org.bukkit.craftbukkit.event.CraftEventFactory.callAreaEffectCloudApplyEvent(this, entities);
+                        if (true) { // Preserve NMS spacing and bracket count for smallest diff
+                        	for (LivingEntity entity : event.getAffectedEntities()) {
+                        		if (entity instanceof CraftLivingEntity) {
+                        			EntityLivingBase entitylivingbase = ((CraftLivingEntity) entity).getHandle();
+                        			// CraftBukkit end
                                     this.field_184504_g.put(entitylivingbase, Integer.valueOf(this.field_70173_aa + this.field_184507_at));
 
                                     for (PotionEffect potioneffect : potions)
